Single cell RNA-Seq reads derived from differentiating B6xCast mouse ESC hybrids (day 0-5) were generated by the Fluidigm C1-HT protocol. It employs a dual barcoding strategy, where read R1 contains a custom barcode (position 1-6, cell barcode) and a unique molecular identifier (position 7-11), read R2 maps to the cDNA sequence and read R3 contains a Nextera (row) barcode. After demultiplexing using the Nextera barcode, read R2 was aligned with STAR (v.2.5.2b) to the mouse genome genome (mm10) and all 96 ERCC spike-in sequences, allowing for unique alignments with a maximum of two mismatches. SNPsplit (v.0.3.2) was used to N-mask the genome using high confidence SNPs. The Drop-seq pipeline (v.1.12) was used to extract both cell barcode and UMI from read R1 and to quantify gene expression. In detail, reads were demultiplexed using the cell barcode, and molecules per gene were counted as the number of unique exon-overlapping UMI barcodes using the mm10 Ensembl gene annotation.  For RNA velocity analyses unique UMI barcodes aligning only to exonic regions (spliced) or overlapping with intronic regions (unspliced) were used. For allele-specific (AS) quantification each read overlapping a SNP position was assigned to its parental genome using SNPsplit (v.0.3.2) and the number of unique UMI barcodes assigned to either parental genome were counted for each gene.

# 2020.7.7: Upload scripts
All the steps for scRNA-Seq read alignment and gene counting are described in the 'alignment.Rnw' script. Each step of the analysis uses R, PERL or JAVA scripts, stored in the "Scripts/" directory. 

In order to reproduce the analyses described in "alignment.Rnw", the following files have to be downloaded:
- scRNA-Seq FASTQ files ("High Output" and "Rapid Run"), cellular barcodes ("GSE151009_RowBarcodes.txt.gz"), and high quality B6xCast SNPs ("GSE151009_SNPs_B6_Cast.txt.gz") from the GEO repository "https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE151009"
- Mouse mm10 FASTA ("Mus_musculus.GRCm38.dna_sm.primary_assembly.fa.gz") and GTF ("Mus_musculus.GRCm38.90.gtf.gz") files from "http://www.ensembl.org/Mus_musculus/Info/Index"
- ERCC92 spike-in FASTA ("ERCC92.fa") and GTF ("ERCC92.gtf") from the GitHub repository
- B6 x Cast SNPs ("mgp.v5.merged.snps_all.dbSNP142.vcf.gz") from "ftp://ftp-mouse.sanger.ac.uk/REL-1505-SNPs_Indels/"

Furthermore, the following softwares have to be installed:
- Drop-seq (v.1.12) JAVA script from "https://github.com/broadinstitute/Drop-seq/"
- SNPsplit (v.0.3.2) PERL script from "https://www.bioinformatics.babraham.ac.uk/projects/SNPsplit/"
- STAR (v.2.5.2b) aligner from "https://github.com/alexdobin/STAR"
- R (v.3.6.1) software from "https://cran.r-project.org/"

Finally, the following R libraries have to be installed: 
- plyr (v.1.8.6)
- data.table (v.1.12.8)
- biomaRt (v.2.40.5)
